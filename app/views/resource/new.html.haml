= link_to('manage resource', show_resource_path(@app), class: 'btn btn-inverse')
%h2 Create Resource for #{@app.name}
- action = @resource.persisted? ? 'update' : 'create'
= form_for @resource, :url => { :action => action }, method: 'post', class: 'form' do |f|
  = f.hidden_field :app_id, value: @resource.app_id
  - if @resource.persisted?
    = f.hidden_field :id
  .control-group
    = f.label :name, "Name"
    .controls
      = f.text_field :name, class: "input-large"
  .control-group
    = f.label :type, "Type"
    .controls
      = f.select :resource_type, options_for_select([["Layout", Resource::TYPE[:template]], ["Image", Resource::TYPE[:image]], ["Script", Resource::TYPE[:script]]]), class: 'resource-type-picker'
  .control-group
    = f.label :main_resource, "Set this as the main layout?"
    - checked =  (@resource.persisted? && @resource.main_layout?) ? 'checked' : 'unchecked'
    %label.checkbox.inline
      %input{type: 'radio', name: 'main_layout', id: 'option1', value: '1', :"#{checked}" => "" }
      Yes
    - checked =  !(@resource.persisted? && @resource.main_layout?) ? 'checked' : 'unchecked'
    %label.checkbox.inline
      %input{type: 'radio', name: 'main_layout', id: 'option2', value: '0', :"#{checked}" => ""}
      No
  .control-group
    = f.label :body, "Resource Body"
    .controls.editor
      = f.text_area :body, class: 'hidden editor'
      .div#editor.input-xxlarge
      :javascript
        droiuby.editor = ace.edit("editor");
        droiuby.editor.setTheme("ace/theme/monokai");
        droiuby.editor.setValue($('textarea.editor').text());
        droiuby.editor.getSession().on('change', function(e) {
            $('textarea.editor').text(droiuby.editor.getValue());
        });
      - if (@resource.resource_type == Resource::TYPE[:script])
        :javascript
          droiuby.editor.getSession().setMode("ace/mode/ruby");
      - else (@resource.resource_type == Resource::TYPE[:template])
        :javascript
          droiuby.editor.getSession().setMode("ace/mode/xml");
  - if @resource.persisted?
    .control-group
      .controls
        = f.submit "Update", class: 'btn btn-primary'
  - else
    .control-group
      .controls
        = f.submit "Submit", class: 'btn btn-primary'
